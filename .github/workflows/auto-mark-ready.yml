name: Auto Mark PRs Ready
on:
  pull_request:
    types: [opened]
  schedule:
    - cron: '*/5 * * * *'  # Every 5 minutes safety net

jobs:
  mark-ready:
    if: github.event.pull_request.draft == true
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
      contents: read
    steps:
      - name: Mark Draft PRs Ready
        uses: actions/github-script@v7
        with:
          script: |
            const { data: prs } = await github.rest.pulls.list({
              owner: context.repo.owner,
              repo: context.repo.repo,
              state: 'open'
            });
            
            for (const pr of prs.filter(p => p.draft)) {
              // Mark ready after 60 seconds
              await github.rest.pulls.update({
                owner: context.repo.owner,
                repo: context.repo.repo,
                pull_number: pr.number,
                draft: false
              });
              
              console.log(`âœ… PR #${pr.number} marked ready for review`);
            }
