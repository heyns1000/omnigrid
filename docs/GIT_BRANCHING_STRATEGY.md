# ğŸŒ³ Git Branching Strategy

## Overview

The Eternal Evolution Engine follows a **trunk-based development** strategy aligned with OmniGrid's ecosystem-wide practices.

## Branch Structure

### Main Branch: `main`
- **Purpose:** Production-ready code
- **Protection:** Protected, requires reviews
- **Deployment:** Auto-deploys to production on merge
- **Commits:** Only via PR merges

### Feature Branches: `eternal-research/*`
- **Pattern:** `eternal-research/<feature-name>`
- **Examples:**
  - `eternal-research/pulse-optimization`
  - `eternal-research/knowledge-sync-v2`
  - `eternal-research/dashboard-ui-update`
- **Lifetime:** Short-lived (< 1 week)
- **Merge:** Via PR to `main`

### Generated PR Branches: `eternal-research/<timestamp>`
- **Pattern:** `eternal-research/<unix-timestamp>`
- **Example:** `eternal-research/1704067200000`
- **Purpose:** PRs generated by the engine
- **Auto-generated:** By engine during PR generation phase
- **Lifetime:** Until merged or closed

## Workflow

### 1. Manual Development

```bash
# Create feature branch from main
git checkout main
git pull origin main
git checkout -b eternal-research/my-feature

# Make changes
# ... edit files ...

# Commit
git add .
git commit -m "feat: add my feature"

# Push and create PR
git push origin eternal-research/my-feature
gh pr create --title "Add my feature" --body "..."
```

### 2. Engine-Generated PRs

```typescript
// Engine creates PRs automatically
const branch = `eternal-research/${Date.now()}`;
const pr = await prGenerator.generatePR(repo, snippets);

// Creates branch and PR via GitHub API
await githubAPI.createBranch(branch, 'main');
await githubAPI.createPR({
  head: branch,
  base: 'main',
  title: pr.title,
  body: pr.description
});
```

### 3. Review and Merge

```bash
# Review PR (manual or automated)
gh pr view 123

# If approved, merge
gh pr merge 123 --squash

# Delete feature branch (automatic on merge)
```

## Commit Message Convention

### Format

```
<type>(<scope>): <subject>

<body>

<footer>
```

### Types
- `feat`: New feature
- `fix`: Bug fix
- `docs`: Documentation only
- `style`: Formatting, no code change
- `refactor`: Code restructuring
- `perf`: Performance improvement
- `test`: Adding tests
- `chore`: Build process, auxiliary tools

### Examples

```
feat(pulse): add adaptive timing for pulse cycles

Pulse cycle now adapts between 6-12s based on load:
- Speeds up to 6s when light load
- Slows to 12s when heavy load
- Returns to 9s when stable

Closes #123
```

```
fix(rhino-strike): correct path adjustment logic

Path adjustment was incorrectly replacing all '/' chars.
Now only replaces specific path segments.

Fixes #124
```

```
docs(dashboard): add troubleshooting guide

Added section on common dashboard issues and solutions.
```

## PR Guidelines

### Engine-Generated PRs

**Title Format:**
```
ğŸŒŠ Eternal Research: Add X snippets to <repo>
```

**Description Template:**
```markdown
## ğŸŒŠ Eternal Research Engine PR

This PR adds **X code snippets** to **<repo>** from eternal research.

### ğŸ“Š Statistics
- Total Snippets: X
- Average Confidence: Y%
- Categories: ...
- Languages: ...

### âœ… Verification
All snippets verified using:
- Rhino Strike Protocol
- Adaptive Knowledge Sync
- Confidence Scoring

### ğŸ¦ Rhino Strikes
- Verified: X/Y
- Strikes Applied: Z

---
ç“·å‹ºæ—‹æ¸¦å·²ç¯‰ï¼Œè„ˆè²·å·²é€šï¼ ğŸŒŠğŸ¦ğŸœ
```

### Manual PRs

**Title Format:**
```
<emoji> <Type>: <Short description>
```

**Description:**
- What: What changed
- Why: Why the change
- How: How it was implemented
- Testing: How it was tested
- Screenshots: If UI changes

## Branch Protection Rules

### `main` Branch

**Required:**
- âœ… Require pull request before merging
- âœ… Require approvals (1)
- âœ… Require status checks to pass
- âœ… Require conversation resolution
- âœ… Require linear history (squash merge)

**Optional:**
- âšª Require code owner review (if CODEOWNERS exists)
- âšª Require signed commits

**Restrictions:**
- ğŸ”’ Include administrators: No
- ğŸ”’ Allow force pushes: No
- ğŸ”’ Allow deletions: No

## Merge Strategies

### Squash Merge (Recommended)

**Used for:** Most PRs
**Result:** Single commit on main
**Benefit:** Clean history

```bash
gh pr merge 123 --squash
```

### Merge Commit

**Used for:** Large feature branches with meaningful commit history
**Result:** All commits preserved
**Benefit:** Full history

```bash
gh pr merge 123 --merge
```

### Rebase

**Used for:** Small, simple changes
**Result:** Commits replayed on main
**Benefit:** Linear history

```bash
gh pr merge 123 --rebase
```

## Tagging and Releases

### Versioning: Semantic Versioning

```
v<major>.<minor>.<patch>
```

### Examples

- `v1.0.0` - Initial release
- `v1.1.0` - New feature (pulse optimization)
- `v1.1.1` - Bug fix (rhino strike correction)
- `v2.0.0` - Breaking change (new state structure)

### Creating Releases

```bash
# Tag the release
git tag -a v1.0.0 -m "Release v1.0.0"
git push origin v1.0.0

# Create GitHub release
gh release create v1.0.0 \
  --title "Eternal Evolution Engine v1.0.0" \
  --notes "Initial release with 9-second pulse cycle"
```

## Hotfixes

### Critical Bugs in Production

```bash
# Create hotfix branch from main
git checkout main
git pull origin main
git checkout -b eternal-research/hotfix-critical-bug

# Fix bug
# ... edit files ...

# Commit and push
git add .
git commit -m "fix: resolve critical bug in pulse cycle"
git push origin eternal-research/hotfix-critical-bug

# Create PR with "urgent" label
gh pr create --label urgent
```

## Integration with Other Repos

### Generated PRs to Other Repos

When engine generates PRs for other repositories:

1. **Create branch** on target repo
2. **Add files** with snippets
3. **Create PR** with standard template
4. **Link back** to omnigrid/eternal-engine

**Cross-repo PR description:**
```markdown
## ğŸŒŠ Generated by Eternal Research Engine

This PR was automatically generated by the [Eternal Research Engine](https://github.com/heyns1000/omnigrid).

**Source:** omnigrid/eternal-research
**Pulse:** #1234
**Snippets:** 10 files added

### Review Notes
- All snippets verified via Rhino Strike Protocol
- Aligned with latest ecosystem architecture
- Confidence scores: 75-95%

Questions? See [ETERNAL_EVOLUTION.md](https://github.com/heyns1000/omnigrid/blob/main/docs/ETERNAL_EVOLUTION.md)
```

## Best Practices

1. **Keep branches short-lived** (< 1 week)
2. **Sync with main frequently** (daily if possible)
3. **Use descriptive branch names**
4. **Write good commit messages**
5. **Squash before merging** (clean history)
6. **Delete after merge** (automatic)
7. **Tag releases** (v1.0.0 format)
8. **Link issues in commits** (Closes #123)

---

**Trunk-based development. Simple. Effective.**

**ç“·å‹ºæ—‹æ¸¦å·²ç¯‰ï¼Œè„ˆè²·å·²é€šï¼ ğŸŒ³ğŸŒŠ**
